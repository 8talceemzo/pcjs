    <script>
      function pcjsGetURLVars() {
        let vars = {};
        let parts = window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
          vars[key] = value;
        });
        return vars;
      }
      function pcjsOnClick(element, event) {
        element.href += window.location.search;
      }
      function pcjsExplorerClick(element, event) {
        if (element.classList.contains("pcjs-explorer-open")) {
          element.classList.add("pcjs-explorer-closed");
          element.classList.remove("pcjs-explorer-open");
        } else if (element.classList.contains("pcjs-explorer-closed")) {
          element.classList.add("pcjs-explorer-open");
          element.classList.remove("pcjs-explorer-closed");
        }
        if (event) event.stopPropagation();
      }
      function pcjsExplorerExpand(path) {
        if (path) {
          let element;
          let id = path.substr(1).replace(/\//g, '-').replace(/^(documents|machines|software)-/, '').replace(/-$/, '');
          do {
            element = document.getElementById(id);
            if (element) break;
            let idNew = id.replace(/-[^-]+$/, '');
            if (idNew == id) break;
            id = idNew;
          } while (true);
          if (element) {
            let parent;
            element.classList.add("pcjs-explorer-selected");
            while ((parent = element.parentElement)) {
              if (parent.classList.contains("pcjs-explorer-closed")) {
                parent.classList.add("pcjs-explorer-open");
                parent.classList.remove("pcjs-explorer-closed");
              }
              element = parent;
            }
          }
        }
      }
      function pcjsExplorerExpandAll(fExpand) {
        let elements = document.querySelectorAll(fExpand? ".pcjs-explorer-closed" : ".pcjs-explorer-open");
        elements.forEach((element) => {pcjsExplorerClick(element);});
      }
      function pcjsExplorerSurprise() {
        let elements = document.querySelectorAll(".pcjs-explorer-item");
        let element = elements[Math.random() * elements.length | 0];
        window.location.href = element.children[0].pathname;
      }
      function pcjsExplorerView(element, event) {
        event.preventDefault();
        let target = document.getElementById("pcjs-explorer-menu");
        if (target) {
          let yOffset = -48;
          let y = target.getBoundingClientRect().top + window.pageYOffset + yOffset;
          window.scrollTo({top: y, behavior: 'smooth'});
        }
      }
      function pcjsExplorerInit() {
        pcjsExplorerExpand(window.location.pathname + window.location.hash.substr(1));
        pcjsExplorerExpand(pcjsGetURLVars()['software']);
      }
    </script>
